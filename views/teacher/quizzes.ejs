<%- include('../layouts/teacher', { body: `
<!-- Page Header -->
<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h4 class="mb-1"><i class="bi bi-question-circle me-2"></i>Quizzes</h4>
    <p class="text-muted mb-0">Create and manage quizzes to assess student learning</p>
  </div>
  <a href="${typeof basePath !== 'undefined' ? basePath : ''}/teacher/quizzes/create" class="btn btn-primary">
    <i class="bi bi-plus-lg me-2"></i>Create Quiz
  </a>
</div>

<!-- Quizzes Grid -->
${quizzes && quizzes.length > 0 ? '<div class="row g-4">' + quizzes.map(quiz => {
  const totalAttempts = quiz.attempts?.length || 0;
  const passedAttempts = quiz.attempts?.filter(a => a.passed).length || 0;
  const avgScore = totalAttempts > 0 ? Math.round(quiz.attempts.reduce((sum, a) => sum + (a.percentage || 0), 0) / totalAttempts) : 0;
  return '<div class="col-md-6 col-lg-4"><div class="card h-100"><div class="card-header bg-white d-flex justify-content-between align-items-start"><div><h6 class="mb-1">' + quiz.title + '</h6><small class="text-muted">' + (quiz.topic?.subject?.name || 'No subject') + ' &bull; ' + (quiz.topic?.name || 'No topic') + '</small></div><div class="dropdown"><button class="btn btn-sm btn-light" data-bs-toggle="dropdown"><i class="bi bi-three-dots-vertical"></i></button><ul class="dropdown-menu dropdown-menu-end"><li><a class="dropdown-item" href="' + (typeof basePath !== 'undefined' ? basePath : '') + '/teacher/quizzes/' + quiz.id + '"><i class="bi bi-eye me-2"></i>View</a></li><li><hr class="dropdown-divider"></li><li><form action="' + (typeof basePath !== 'undefined' ? basePath : '') + '/teacher/quizzes/' + quiz.id + '/delete" method="POST" onsubmit="return confirm(\\'Delete this quiz?\\');"><button type="submit" class="dropdown-item text-danger"><i class="bi bi-trash me-2"></i>Delete</button></form></li></ul></div></div><div class="card-body"><p class="text-muted small mb-3">' + (quiz.description || 'No description') + '</p><div class="d-flex gap-2 flex-wrap mb-3"><span class="badge bg-primary">' + (quiz.questions?.length || 0) + ' questions</span>' + (quiz.timeLimit ? '<span class="badge bg-warning text-dark">' + quiz.timeLimit + ' min</span>' : '<span class="badge bg-light text-dark">No time limit</span>') + '<span class="badge bg-info">' + quiz.passingScore + '% to pass</span>' + (quiz.class ? '<span class="badge bg-success">' + quiz.class.name + '</span>' : '') + '</div><div class="d-flex justify-content-between text-muted small"><span><i class="bi bi-people me-1"></i>' + totalAttempts + ' attempts</span><span><i class="bi bi-check-circle me-1"></i>' + passedAttempts + ' passed</span><span><i class="bi bi-graph-up me-1"></i>' + avgScore + '% avg</span></div></div><div class="card-footer bg-white"><small class="text-muted">Created ' + new Date(quiz.createdAt).toLocaleDateString() + '</small></div></div></div>';
}).join('') + '</div>' : '<div class="text-center py-5"><div class="mb-4"><i class="bi bi-question-circle fs-1 text-muted"></i></div><h5>No Quizzes Yet</h5><p class="text-muted mb-4">Create your first quiz to assess student learning.</p><a href="' + (typeof basePath !== 'undefined' ? basePath : '') + '/teacher/quizzes/create" class="btn btn-primary"><i class="bi bi-plus-lg me-2"></i>Create Your First Quiz</a></div>'}
`, activePage: 'quizzes', pageTitle: 'Quizzes' }) %>
